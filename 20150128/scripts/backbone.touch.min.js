/*!
 * backbone.touch - v0.4.0
 * Copyright 2012, Raymond Julin (@nervetattoo)
 * backbone.touch.js may be freely distributed under the MIT license.
 */!function(a,b){"use strict";"function"==typeof define&&define.amd?define(["underscore","backbone"],function(){return b.apply(a,arguments)}):"object"==typeof module&&module.exports?module.exports=b.call(a,require("underscore"),require("backbone")):b.call(a,a._,a.Backbone)}("object"==typeof global?global:this,function(a,b){"use strict";var c=function(b,c){return b&&b[c]?a.isFunction(b[c])?b[c]():b[c]:null},d=/^(\S+)\s*(.*)$/;return a.extend(b.View.prototype,{_touching:!1,touchPrevents:!0,touchThreshold:10,isTouch:this.document&&"ontouchstart"in this.document&&!("callPhantom"in this),delegateEvents:function(b){if(b||(b=c(this,"events"))){this.undelegateEvents();var e=".delegateEvents"+this.cid;a(b).each(function(c,f){if(a.isFunction(c)||(c=this[b[f]]),!c)throw new Error('Method "'+b[f]+'" does not exist');var g=f.match(d),h=g[1],i=g[2],j=a.bind(this._touchHandler,this);c=a.bind(c,this),this._useTouchHandlers(h,i)?(this.$el.on("touchstart"+e,i,j),this.$el.on("touchend"+e,i,{method:c},j)):(h+=e,""===i?this.$el.bind(h,c):this.$el.on(h,i,c))},this)}},_useTouchHandlers:function(a){return this.isTouch&&"click"===a},_touchHandler:function(a){var b=a.originalEvent||a;if("changedTouches"in b){var c=b.changedTouches[0],d=c.clientX,e=c.clientY;switch(a.type){case"touchstart":this._touching=[d,e];break;case"touchend":var f=this._touching[0],g=this._touching[1],h=this.touchThreshold;if(f+h>d&&d>f-h&&g+h>e&&e>g-h){if(this._touching=!1,this.touchPrevents){var i=a.currentTarget.tagName;("BUTTON"===i||"A"===i)&&(a.preventDefault(),a.stopPropagation())}a.data.method(a)}}}}}),b});